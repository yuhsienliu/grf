<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized Random Forests • grf</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><script src="extra.js"></script><meta property="og:title" content="Generalized Random Forests">
<meta property="og:description" content="A pluggable package for forest-based statistical estimation and inference.
    GRF currently provides methods for non-parametric least-squares regression,
    quantile regression, and treatment effect estimation (optionally using instrumental
    variables).">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">grf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/grf.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/categorical_inputs.html">Categorical inputs</a>
    </li>
    <li>
      <a href="articles/ci_and_num.trees.html">Confidence intervals and the number of trees</a>
    </li>
    <li>
      <a href="articles/diagnostics.html">Evaluating a causal forest fit</a>
    </li>
    <li>
      <a href="articles/sample_weighting_examples.html">Sample weighting</a>
    </li>
  </ul>
</li>
<li>
  <a href="REFERENCE.html">Algorithm reference</a>
</li>
<li>
  <a href="DEVELOPING.html">Developing</a>
</li>
<li>
  <a href="CHANGELOG.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/grf-labs/grf">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><a href="https://cran.r-project.org/package=grf"><img src="https://www.r-pkg.org/badges/version/grf" alt="CRANstatus"></a> <img src="http://cranlogs.r-pkg.org/badges/grand-total/grf" alt="CRAN Downloads overall"><a href="https://travis-ci.com/grf-labs/grf"><img src="https://travis-ci.com/grf-labs/grf.svg?branch=master" alt="Build Status"></a></p>
<div id="grf-generalized-random-forests" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#grf-generalized-random-forests" class="anchor"></a>grf: generalized random forests</h1></div>
<p>A pluggable package for forest-based statistical estimation and inference. GRF currently provides non-parametric methods for least-squares regression, quantile regression, and treatment effect estimation (optionally using instrumental variables).</p>
<p>In addition, GRF supports ‘honest’ estimation (where one subset of the data is used for choosing splits, and another for populating the leaves of the tree), and confidence intervals for least-squares regression and treatment effect estimation.</p>
<p>Some helpful links for getting started:</p>
<ul>
<li>The <a href="https://grf-labs.github.io/grf">R package documentation</a> contains usage examples and method reference.</li>
<li>The <a href="https://grf-labs.github.io/grf/REFERENCE.html">GRF reference</a> gives a detailed description of the GRF algorithm and includes troubleshooting suggestions.</li>
<li>For community questions and answers around usage, see <a href="https://github.com/grf-labs/grf/issues?q=label%3Aquestion">Github issues labelled ‘question’</a>.</li>
</ul>
<p>The repository first started as a fork of the <a href="https://github.com/imbs-hl/ranger">ranger</a> repository – we owe a great deal of thanks to the ranger authors for their useful and free package.</p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>The latest release of the package can be installed through CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"grf"</span>)</a></code></pre></div>
<p>Any published release can also be installed from source:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"https://raw.github.com/grf-labs/grf/master/releases/grf_1.0.1.tar.gz"</span>, <span class="dt">repos =</span> <span class="ot">NULL</span>, <span class="dt">type =</span> <span class="st">"source"</span>)</a></code></pre></div>
<p><code>conda</code> users can install from the <a href="https://anaconda.org/conda-forge/r-grf">conda-forge</a> channel:</p>
<pre><code>conda install -c conda-forge r-grf</code></pre>
<p>Note that to install from source, a compiler that implements C++11 is required (clang 3.3 or higher, or g++ 4.8 or higher). If installing on Windows, the RTools toolchain is also required.</p>
</div>
<div id="usage-examples" class="section level3">
<h3 class="hasAnchor">
<a href="#usage-examples" class="anchor"></a>Usage Examples</h3>
<p>The following script demonstrates how to use GRF for heterogeneous treatment effect estimation. For examples of how to use types of forest, as for quantile regression and causal effect estimation using instrumental variables, please consult the R <a href="https://grf-labs.github.io/grf/reference/index.html">documentation</a> on the relevant forest methods (quantile_forest, instrumental_forest, etc.).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(grf)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Generate data.</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">n &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">p &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">X &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n <span class="op">*</span><span class="st"> </span>p), n, p)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">X.test &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>, <span class="dv">101</span>, p)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">X.test[, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">101</span>)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co"># Train a causal forest.</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">W &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(n, <span class="dv">1</span>, <span class="fl">0.4</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span> <span class="op">*</span><span class="st"> </span>(X[, <span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">Y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span>(X[, <span class="dv">1</span>], <span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>W <span class="op">+</span><span class="st"> </span>X[, <span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">pmin</a></span>(X[, <span class="dv">3</span>], <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">tau.forest &lt;-<span class="st"> </span><span class="kw"><a href="reference/causal_forest.html">causal_forest</a></span>(X, Y, W)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co"># Estimate treatment effects for the training data using out-of-bag prediction.</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">tau.hat.oob &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(tau.forest)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(tau.hat.oob<span class="op">$</span>predictions)</a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co"># Estimate treatment effects for the test sample.</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">tau.hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(tau.forest, X.test)</a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(X.test[, <span class="dv">1</span>], tau.hat<span class="op">$</span>predictions, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(tau.hat<span class="op">$</span>predictions, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">xlab =</span> <span class="st">"x"</span>, <span class="dt">ylab =</span> <span class="st">"tau"</span>, <span class="dt">type =</span> <span class="st">"l"</span>)</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(X.test[, <span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span>(<span class="dv">0</span>, X.test[, <span class="dv">1</span>]), <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-23" data-line-number="23"></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co"># Estimate the conditional average treatment effect on the full sample (CATE).</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="kw"><a href="reference/average_treatment_effect.html">average_treatment_effect</a></span>(tau.forest, <span class="dt">target.sample =</span> <span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb4-26" data-line-number="26"></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co"># Estimate the conditional average treatment effect on the treated sample (CATT).</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co"># Here, we don't expect much difference between the CATE and the CATT, since</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co"># treatment assignment was randomized.</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="kw"><a href="reference/average_treatment_effect.html">average_treatment_effect</a></span>(tau.forest, <span class="dt">target.sample =</span> <span class="st">"treated"</span>)</a>
<a class="sourceLine" id="cb4-31" data-line-number="31"></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co"># Add confidence intervals for heterogeneous treatment effects; growing more trees is now recommended.</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33">tau.forest &lt;-<span class="st"> </span><span class="kw"><a href="reference/causal_forest.html">causal_forest</a></span>(X, Y, W, <span class="dt">num.trees =</span> <span class="dv">4000</span>)</a>
<a class="sourceLine" id="cb4-34" data-line-number="34">tau.hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(tau.forest, X.test, <span class="dt">estimate.variance =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-35" data-line-number="35">sigma.hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(tau.hat<span class="op">$</span>variance.estimates)</a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(X.test[, <span class="dv">1</span>], tau.hat<span class="op">$</span>predictions, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(tau.hat<span class="op">$</span>predictions <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>sigma.hat, tau.hat<span class="op">$</span>predictions <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>sigma.hat, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">xlab =</span> <span class="st">"x"</span>, <span class="dt">ylab =</span> <span class="st">"tau"</span>, <span class="dt">type =</span> <span class="st">"l"</span>)</a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(X.test[, <span class="dv">1</span>], tau.hat<span class="op">$</span>predictions <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>sigma.hat, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(X.test[, <span class="dv">1</span>], tau.hat<span class="op">$</span>predictions <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>sigma.hat, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(X.test[, <span class="dv">1</span>], <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span>(<span class="dv">0</span>, X.test[, <span class="dv">1</span>]), <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-40" data-line-number="40"></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co"># In some examples, pre-fitting models for Y and W separately may</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co"># be helpful (e.g., if different models use different covariates).</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="co"># In some applications, one may even want to get Y.hat and W.hat</span></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co"># using a completely different method (e.g., boosting).</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"><span class="co"># Generate new data.</span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47">n &lt;-<span class="st"> </span><span class="dv">4000</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48">p &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb4-49" data-line-number="49">X &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n <span class="op">*</span><span class="st"> </span>p), n, p)</a>
<a class="sourceLine" id="cb4-50" data-line-number="50">TAU &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>X[, <span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb4-51" data-line-number="51">W &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(n, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>X[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>X[, <span class="dv">2</span>])))</a>
<a class="sourceLine" id="cb4-52" data-line-number="52">Y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">pmax</a></span>(X[, <span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>X[, <span class="dv">3</span>], <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(X[, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>]) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>W <span class="op">*</span><span class="st"> </span>TAU <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(n)</a>
<a class="sourceLine" id="cb4-53" data-line-number="53"></a>
<a class="sourceLine" id="cb4-54" data-line-number="54">forest.W &lt;-<span class="st"> </span><span class="kw"><a href="reference/regression_forest.html">regression_forest</a></span>(X, W, <span class="dt">tune.parameters =</span> <span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb4-55" data-line-number="55">W.hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(forest.W)<span class="op">$</span>predictions</a>
<a class="sourceLine" id="cb4-56" data-line-number="56"></a>
<a class="sourceLine" id="cb4-57" data-line-number="57">forest.Y &lt;-<span class="st"> </span><span class="kw"><a href="reference/regression_forest.html">regression_forest</a></span>(X, Y, <span class="dt">tune.parameters =</span> <span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb4-58" data-line-number="58">Y.hat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(forest.Y)<span class="op">$</span>predictions</a>
<a class="sourceLine" id="cb4-59" data-line-number="59"></a>
<a class="sourceLine" id="cb4-60" data-line-number="60">forest.Y.varimp &lt;-<span class="st"> </span><span class="kw"><a href="reference/variable_importance.html">variable_importance</a></span>(forest.Y)</a>
<a class="sourceLine" id="cb4-61" data-line-number="61"></a>
<a class="sourceLine" id="cb4-62" data-line-number="62"><span class="co"># Note: Forests may have a hard time when trained on very few variables</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63"><span class="co"># (e.g., ncol(X) = 1, 2, or 3). We recommend not being too aggressive</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64"><span class="co"># in selection.</span></a>
<a class="sourceLine" id="cb4-65" data-line-number="65">selected.vars &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(forest.Y.varimp <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(forest.Y.varimp) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb4-66" data-line-number="66"></a>
<a class="sourceLine" id="cb4-67" data-line-number="67">tau.forest &lt;-<span class="st"> </span><span class="kw"><a href="reference/causal_forest.html">causal_forest</a></span>(X[, selected.vars], Y, W,</a>
<a class="sourceLine" id="cb4-68" data-line-number="68">                            <span class="dt">W.hat =</span> W.hat, <span class="dt">Y.hat =</span> Y.hat,</a>
<a class="sourceLine" id="cb4-69" data-line-number="69">                            <span class="dt">tune.parameters =</span> <span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb4-70" data-line-number="70"></a>
<a class="sourceLine" id="cb4-71" data-line-number="71"><span class="co"># Check whether causal forest predictions are well calibrated.</span></a>
<a class="sourceLine" id="cb4-72" data-line-number="72"><span class="kw"><a href="reference/test_calibration.html">test_calibration</a></span>(tau.forest)</a></code></pre></div>
</div>
<div id="developing" class="section level3">
<h3 class="hasAnchor">
<a href="#developing" class="anchor"></a>Developing</h3>
<p>In addition to providing out-of-the-box forests for quantile regression and causal effect estimation, GRF provides a framework for creating forests tailored to new statistical tasks. If you’d like to develop using GRF, please consult the <a href="https://grf-labs.github.io/grf/REFERENCE.html">algorithm reference</a> and <a href="https://grf-labs.github.io/grf/DEVELOPING.html">development guide</a>.</p>
</div>
<div id="references" class="section level3">
<h3 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h3>
<p>Susan Athey, Julie Tibshirani and Stefan Wager. <b>Generalized Random Forests</b>, <i>Annals of Statistics</i> 47.2 (2019): 1148-1178. [<a href="https://arxiv.org/abs/1610.01271">arxiv</a>]</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=grf">https://​cloud.r-project.org/​package=grf</a>
</li>
<li>Browse source code at <br><a href="https://github.com/grf-labs/grf">https://​github.com/​grf-labs/​grf</a>
</li>
<li>Report a bug at <br><a href="https://github.com/grf-labs/grf/issues">https://​github.com/​grf-labs/​grf/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Julie Tibshirani <br><small class="roles"> Author, maintainer </small>  </li>
<li>Susan Athey <br><small class="roles"> Author </small>  </li>
<li>Stefan Wager <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Julie Tibshirani, Susan Athey, Stefan Wager.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
